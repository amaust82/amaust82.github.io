"use strict";(self.webpackChunkcoc_ibo=self.webpackChunkcoc_ibo||[]).push([[435],{887:(C,p,r)=>{r.d(p,{WJ:()=>h,LL:()=>m});const y={aztecs:{action:"Attack",advancements:[{category:"Warfare",requiredAdvancements:1,name:"Captives",description:"Up to 4 defeated non-Leader Army units are placed here as Captives. (&frac12; point each)"},{category:"Spirituality",requiredAdvancements:1,name:"Human Sacrifice",description:"Will spend Captives as culture, if need be."},{category:"Traditions",requiredAdvancements:1,name:"Aztec Gold",description:'FOUND in reverse Terrain order. During "Complete Objectives", Gain 1 culture per 3 mountain spaces on or adjacent to his cities.'},{category:"Any Government",requiredAdvancements:1,name:"Tribute Empire",description:'During "Complete Objectives", barbarian cities within 2 each lose an Infantry unit and become a Captive, if possible.'}]},babylonia:{action:"Advance",advancements:[{category:"Construction",requiredAdvancements:2,name:"Canals",description:'During "Complete Objectives", gain 1 mood for each size-2+ city. Pay 6 mood to CONSTRUCT.'},{category:"Education",requiredAdvancements:1,name:"Code of Laws",description:"Gains an Action card with each successful INFLUENCE CULTURE action."},{category:"Science",requiredAdvancements:1,name:"Star Catalogues",description:"Gains 1 culture when triggering an event."},{category:"Any Government",requiredAdvancements:1,name:"Ziggurats",description:"When acquired, perform an ADVANCE, CONSTRUCT and gain 1 culture."}]},carthage:{action:"Recruit",advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Warbeasts",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Maritime",requiredAdvancements:1,name:"Hegemony",description:'After a FOUND, IBO removes 1 ship from his largest fleet. If done so, IBO takes another action. (Could be a Pirate ship because of "Pirate Allies")'},{category:"Maritime",requiredAdvancements:2,name:"Pirate Allies",description:"Pirates are considered IBO's ships, during IBO's turn"},{category:"Warfare",requiredAdvancements:2,name:"Mercenaries",description:'After RECRUIT, trigger a "Barbarians Move" Event on yourself.'}]},celts:{action:"Attack",advancements:[{category:"Warfare",requiredAdvancements:1,name:"Tribal Warfare",description:"+1 strength in land battles for every 2 barbarian units within 2 of battle."},{category:"Warfare",requiredAdvancements:2,name:"Tribal Allies",description:'IBO will never target barbarians with ATTACKS. IBO ignores all "Barbarians Move" events.'},{category:"Spirituality",requiredAdvancements:2,name:"Druidic Influence",description:"May INFLUENCE CULTURE on barbarian cities. Mark success with culture. Worth 1 point. (Max 1 per city and removed if captured)"},{category:"Spirituality",requiredAdvancements:1,name:"Tribute Trade",description:'During "Complete Objectives", gain 1 mood for each barbarian city within 2. Pay 3 mood to ADVANCE.'}]},china:{action:"Construct",advancements:[{category:"Agriculture",requiredAdvancements:3,name:"Rice Paddies",description:'During "Complete Objectives", gain 1 mood per grassland on or adjacent to IBO\'s cities. Pay 4 mood to ADVANCE.'},{category:"Agriculture",requiredAdvancements:2,name:"Sprawling",description:"When acquired, perform a FOUND. After this FOUND, shift all Settlements one extra space swapping with any city-piece they run into."},{category:"Science",requiredAdvancements:2,name:"Fireworks",description:'When defending, get 1 "Block", in the 1st round of combat.'},{category:"Any Government",requiredAdvancements:1,name:"Fighting Bands",description:"After a FOUND action, make the city happy and perform a RECRUIT action in the new city."}]},egypt:{action:"Influence",advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Flood Plains",description:'During "Complete Objectives", gain 1 mood for each barren hex adjacent to his cities. Pay 6 mood to CONSTRUCT.'},{category:"Construction",requiredAdvancements:2,name:"Architecture",description:"When acquired, perform a CONSTRUCT."},{category:"Spirituality",requiredAdvancements:1,name:"Embalming",description:"Gains 1 culture after every battle he takes part in."},{category:"Spirituality",requiredAdvancements:2,name:"Man God",description:"Gain an extra action with his 1st and 2nd Government Advancements. (Perform immediately if IBO already has them.)"}]},greece:{action:"Recruit",advancements:[{category:"Education",requiredAdvancements:1,name:"Formal Training",description:'During RECRUIT, gain 1 mood for each Academy. During "Complete Objectives", Pay 4 mood to ADVANCE.'},{category:"Warfare",requiredAdvancements:2,name:"Spartans",description:"You can not play Action cards, in 1st round of battle."},{category:"Traditions",requiredAdvancements:1,name:"Hellenization",description:"IBO can INFLUENCE CULTURE from your cities under his Influence."},{category:"Any Government",requiredAdvancements:1,name:"City-States",description:"After CONSTRUCT, IBO's Settler is moved to the largest city in City-Track Order that can still grow."}]},huns:{action:"Construct",advancements:[{category:"Agriculture",requiredAdvancements:1,name:"Nomads",description:"During setup place settlements on 0, 1, 3, and 5 of scale."},{category:"Agriculture",requiredAdvancements:2,name:"Mounted Archers",description:"Leader leaves behind cavalry instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:1,name:"Raiders",description:"Your lone settlers within \"Land Aggression Range\" can't FOUND or form Trade Routes with IBO's cities."},{category:"Any Government",requiredAdvancements:1,name:"Hunnic Tribes",description:'Will pay a culture to redirect "Barbarians Move" Events to you instead of him.'}]},india:{action:"Influence",advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Indian Elephants",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Spirituality",requiredAdvancements:2,name:"Proselytism",description:"Range for INFLUENCE CULTURE is increase by 1."},{category:"Economy",requiredAdvancements:2,name:"Prosperity",description:"During Raze City, all his cities are made happy . Gains 1 culture for each of your cities under his influence."},{category:"Traditions",requiredAdvancements:2,name:"Peace & Poetry",description:'During "Complete Objectives", Gain 1 mood for each happy city. Pay 4 mood to ADVANCE.'}]},japan:{action:"Attack",advancements:[{category:"Agriculture",requiredAdvancements:3,name:"Pottery",description:'After an ADVANCE, gain 1 mood . During "Complete Objectives", pay 3 mood for 2 culture.'},{category:"Agriculture",requiredAdvancements:2,name:"Horsemanship",description:"Leader leaves behind cavalry instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:1,name:"Subterfuge",description:"If you play a Non-Combat Action card and you're within 2 of IBO's cities, roll a die. On 5 or 6, return card to your hand canceled."},{category:"Any Government",requiredAdvancements:1,name:"Shogunate",description:'During "Complete Objectives", IBO gains 1 action card. In Battle, if his action card fails to trigger, discard it and IBO gains a combat die.'}]},maya:{action:"Advance",advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Terracing",description:'FOUND in reverse Terrain order. During "Complete Objectives", gain 1 mood per mountain on or adjacent to his cities. Pay 6 mood to CONSTRUCT.'},{category:"Traditions",requiredAdvancements:1,name:"Stelas",description:"After CONSTRUCT, gain 1 culture."},{category:"Traditions",requiredAdvancements:2,name:"Ballcourts",description:"After RECRUIT, IBO recruits 1 more unit. Starting again at beginning of reverse City-Track order."},{category:"Science",requiredAdvancements:2,name:"Calendar",description:"IBO pays 1 culture to cancel any event icon he triggers."}]},persia:{action:"Influence",advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Elephants",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:2,name:"Immortals",description:"In Battle, IBO spends up to 4 culture for +1 combat value each, if it gains another hit"},{category:"Spirituality",requiredAdvancements:2,name:"Zoroastrianism",description:"May target one of your army units outside a city with an INFLUENCE CULTURE action. (Causes battle, if in army)"},{category:"Economy",requiredAdvancements:2,name:"Banking",description:'During "Complete Objectives", if he has any culture, he gains 1 culture.'}]},phoenicia:{action:"Advance",advancements:[{category:"Maritime",requiredAdvancements:1,name:"City Independence",description:"IBO's Ports can not be Culturally Influence and are worth an extra &frac12; victory point."},{category:"Maritime",requiredAdvancements:2,name:"Biremes",description:"+2 combat value in Naval Combat."},{category:"Education",requiredAdvancements:1,name:"Alphabet",description:'During "Complete Objectives", gain 1 mood for each of your cities within 2 of his cities. Pay 4 mood to both ADVANCE and Gain 1 culture.'},{category:"Economy",requiredAdvancements:2,name:"Cedars & Dyes",description:'During "Complete Objectives", if you have a port within 3 of one of his ports, IBO gains 2 culture.'}]},rome:{action:"Construct",advancements:[{category:"Construction",requiredAdvancements:2,name:"Aqueducts",description:'When acquired, perform an ADVANCE in Agriculture. IBO ignores "Exhausted Land" Events.'},{category:"Construction",requiredAdvancements:3,name:"Imperial Roads",description:"Before defending an attack, IBO will move one unit from the closest city to the attacked city. (May exceed City-Limit but not 4.)"},{category:"Economy",requiredAdvancements:1,name:"Slave Economy",description:"After CONSTRUCT (not FOUND), IBO gains mood. Pay 3 mood and make city angry to perform CONSTRUCT (not FOUND) again in same city."},{category:"Any Government",requiredAdvancements:1,name:"Provinces",description:"Leader leaves behind culture instead of infantry when it moves and captured cities are made neutral instead of angry."}]},vikings:{action:"Recruit",advancements:[{category:"Maritime",requiredAdvancements:1,name:"Shipcraft",description:"During land ATTACK or FOUND, IBO may count through a single water without ships in the sea area. "},{category:"Maritime",requiredAdvancements:2,name:"Longships",description:"When acquired, RECRUIT a Ship (if possible) +1 Naval Aggression Range."},{category:"Economy",requiredAdvancements:2,name:"Marauders",description:'During "Complete Objectives", you lose 1 resource for each of your cities within 2 of IBO\'s ships.'},{category:"Spirituality",requiredAdvancements:2,name:"Runestones",description:"After any battle that IBO loses 2+ units, place 1 culture on this card. Each mood is 1 victory point."}]}},m=[{name:"aztecs",display:"Aztecs"},{name:"babylonia",display:"Babylonia"},{name:"carthage",display:"Carthage"},{name:"celts",display:"Celts"},{name:"china",display:"China"},{name:"egypt",display:"Egypt"},{name:"greece",display:"Greece"},{name:"huns",display:"Huns"},{name:"india",display:"India"},{name:"japan",display:"Japan"},{name:"maya",display:"Maya"},{name:"persia",display:"Persia"},{name:"phoenicia",display:"Phoenicia"},{name:"rome",display:"Rome"},{name:"vikings",display:"Vikings"}],h=m.map(c=>({...c,board:y[c.name]})).reduce((c,o)=>({...c,[o.name]:o}),{})},3435:(C,p,r)=>{r.d(p,{mj:()=>O});var y=r(8645);const m={now:()=>(m.delegate||Date).now(),delegate:void 0};class h extends y.x{constructor(a=1/0,i=1/0,e=m){super(),this._bufferSize=a,this._windowTime=i,this._timestampProvider=e,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=i===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,i)}next(a){const{isStopped:i,_buffer:e,_infiniteTimeWindow:t,_timestampProvider:n,_windowTime:s}=this;i||(e.push(a),!t&&e.push(n.now()+s)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const i=this._innerSubscribe(a),{_infiniteTimeWindow:e,_buffer:t}=this,n=t.slice();for(let s=0;s<n.length&&!a.closed;s+=e?1:2)a.next(n[s]);return this._checkFinalizedStatuses(a),i}_trimBuffer(){const{_bufferSize:a,_timestampProvider:i,_buffer:e,_infiniteTimeWindow:t}=this,n=(t?1:2)*a;if(a<1/0&&n<e.length&&e.splice(0,e.length-n),!t){const s=i.now();let g=0;for(let A=1;A<e.length&&e[A]<=s;A+=2)g=A;g&&e.splice(0,g+1)}}}var c=r(4036),o=r(8180),b=r(7398);class u{get advancements(){return[...this._advancements]}constructor({id:a,civ:i,advancements:e,created:t,updated:n}){this.updated=null,this.id=a,this.civ=i,this._advancements=[...e||[]],this.created=t?new Date(t):new Date,this.updated=n?new Date(n):null}static fromSave(a){return new u(a)}toggleAdvancement(a){this._advancements=this._advancements.includes(a)?this._advancements.filter(i=>i!==a):[...this._advancements,a]}toSave(a){return{name:`${a} (${(new Date).toLocaleDateString()})`,id:this.id,civ:this.civ,created:this.created,updated:new Date,advancements:[...this._advancements]}}}var v=r(887),f=r(4946);const d_gameSave="coc-ibo-datastore--game--";let O=(()=>{var l;class a{constructor(){this.gameList=new h(1),this.gameList$=this.gameList.asObservable(),this.clearEmptyGames(),this.loadGameList()}createGame(e){return(0,c.z)(this.createNewGame(e))}clearSaves(){localStorage.clear(),this.loadGameList()}loadGame(e){const t=u.fromSave(JSON.parse(localStorage.getItem(`${d_gameSave}${e}`)||"{}"));if(!(t||{}).id)throw new Error(e);return{game:t,civ:v.WJ[t.civ]}}saveGame(e){const n=e.toSave((v.WJ[e.civ]||{}).display||"");return this.createOrUpdateGameList(n),localStorage.setItem(`${d_gameSave}${n.id}`,JSON.stringify(n)),n.id}deleteGame(e){localStorage.removeItem(`${d_gameSave}${e}`),this.deleteFromGameList(e)}clearEmptyGames(){localStorage.removeItem(`${d_gameSave}`)}deleteFromGameList(e){this.gameList$.pipe((0,o.q)(1)).subscribe(t=>this.updateGameListStorage(t.filter(n=>n.id!==e)))}createOrUpdateGameList(e){this.gameList$.pipe((0,o.q)(1)).subscribe(t=>{let s=t.find(g=>g.id===e.id)?t.filter(g=>g.id!==e.id):[...t];s=[...s,{id:e.id,name:e.name}],this.updateGameListStorage(s)})}updateGameListStorage(e){localStorage.setItem("coc-ibo-datastore--gamelist",JSON.stringify(e||null)),this.gameList.next(e||null)}loadGameList(){const e=JSON.parse(localStorage.getItem("coc-ibo-datastore--gamelist")||"[]");return this.gameList.next(e||[]),this.gameList$}createNewGame(e){return this.gameList$.pipe((0,o.q)(1),(0,b.U)(t=>{const n=this.generateUniqueKey(t.map(s=>s.id));return this.saveGame(new u({id:n,civ:e}))}))}generateUniqueKey(e=[]){let t="",n=!1;for(;!n;)t=this.generateSubKey()+"-"+this.generateSubKey()+"-"+this.generateSubKey(),n=!e.includes(t);return t}generateSubKey(e=4){let t="",n=0;for(;n<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random())),n+=1;return t}}return(l=a).\u0275fac=function(e){return new(e||l)},l.\u0275prov=f.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),a})()},4036:(C,p,r)=>{r.d(p,{z:()=>h});var y=r(6973),m=r(1887);function h(c,o){const b="object"==typeof o;return new Promise((u,v)=>{const f=new m.Hp({next:d=>{u(d),f.unsubscribe()},error:v,complete:()=>{b?u(o.defaultValue):v(new y.K)}});c.subscribe(f)})}}}]);