"use strict";(self.webpackChunkcoc_ibo=self.webpackChunkcoc_ibo||[]).push([[446],{1798:(C,u,r)=>{r.d(u,{WJ:()=>a,LL:()=>p});const y={aztecs:{advancements:[{category:"Warfare",requiredAdvancements:1,name:"Captives",description:"Up to 4 defeated non-Leader Army units are placed here as Captives. (&frac12; point each)"},{category:"Spirituality",requiredAdvancements:1,name:"Human Sacrifice",description:"Will spend Captives as culture, if need be."},{category:"Traditions",requiredAdvancements:1,name:"Aztec Gold",description:'FOUND in reverse Terrain order. During "Complete Objectives", Gain 1 culture per 3 mountain spaces on or adjacent to his cities.'},{category:"Any Government",requiredAdvancements:1,name:"Tribute Empire",description:'During "Complete Objectives", barbarian cities within 2 each lose an Infantry unit and become a Captive, if possible.'}]},babylonia:{advancements:[{category:"Construction",requiredAdvancements:2,name:"Canals",description:'During "Complete Objectives", gain 1 mood for each size-2+ city. Pay 6 mood to CONSTRUCT.'},{category:"Education",requiredAdvancements:1,name:"Code of Laws",description:"Gains an Action card with each successful INFLUENCE CULTURE action."},{category:"Science",requiredAdvancements:1,name:"Star Catalogues",description:"Gains 1 culture when triggering an event."},{category:"Any Government",requiredAdvancements:1,name:"Ziggurats",description:"When acquired, perform an ADVANCE, CONSTRUCT and gain 1 culture."}]},carthage:{advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Warbeasts",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Maritime",requiredAdvancements:1,name:"Hegemony",description:'After a FOUND, IBO removes 1 ship from his largest fleet. If done so, IBO takes another action. (Could be a Pirate ship because of "Pirate Allies")'},{category:"Maritime",requiredAdvancements:2,name:"Pirate Allies",description:"Pirates are considered IBO's ships, during IBO's turn"},{category:"Warfare",requiredAdvancements:2,name:"Mercenaries",description:'After RECRUIT, trigger a "Barbarians Move" Event on yourself.'}]},celts:{advancements:[{category:"Warfare",requiredAdvancements:1,name:"Tribal Warfare",description:"+1 strength in land battles for every 2 barbarian units within 2 of battle."},{category:"Warfare",requiredAdvancements:2,name:"Tribal Allies",description:'IBO will never target barbarians with ATTACKS. IBO ignores all "Barbarians Move" events.'},{category:"Spirituality",requiredAdvancements:2,name:"Druidic Influence",description:"May INFLUENCE CULTURE on barbarian cities. Mark success with culture. Worth 1 point. (Max 1 per city and removed if captured)"},{category:"Spirituality",requiredAdvancements:1,name:"Tribute Trade",description:'During "Complete Objectives", gain 1 mood for each barbarian city within 2. Pay 3 mood to ADVANCE.'}]},china:{advancements:[{category:"Agriculture",requiredAdvancements:3,name:"Rice Paddies",description:'During "Complete Objectives", gain 1 mood per grassland on or adjacent to IBO\'s cities. Pay 4 mood to ADVANCE.'},{category:"Agriculture",requiredAdvancements:2,name:"Sprawling",description:"When acquired, perform a FOUND. After this FOUND, shift all Settlements one extra space swapping with any city-piece they run into."},{category:"Science",requiredAdvancements:2,name:"Fireworks",description:'When defending, get 1 "Block", in the 1st round of combat.'},{category:"Any Government",requiredAdvancements:1,name:"Fighting Bands",description:"After a FOUND action, make the city happy and perform a RECRUIT action in the new city."}]},egypt:{advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Flood Plains",description:'During "Complete Objectives", gain 1 mood for each barren hex adjacent to his cities. Pay 6 mood to CONSTRUCT.'},{category:"Construction",requiredAdvancements:2,name:"Architecture",description:"When acquired, perform a CONSTRUCT."},{category:"Spirituality",requiredAdvancements:1,name:"Embalming",description:"Gains 1 culture after every battle he takes part in."},{category:"Spirituality",requiredAdvancements:2,name:"Man God",description:"Gain an extra action with his 1st and 2nd Government Advancements. (Perform immediately if IBO already has them.)"}]},greece:{advancements:[{category:"Education",requiredAdvancements:1,name:"Formal Training",description:'During RECRUIT, gain 1 mood for each Academy. During "Complete Objectives", Pay 4 mood to ADVANCE.'},{category:"Warfare",requiredAdvancements:2,name:"Spartans",description:"You can not play Action cards, in 1st round of battle."},{category:"Traditions",requiredAdvancements:1,name:"Hellenization",description:"IBO can INFLUENCE CULTURE from your cities under his Influence."},{category:"Any Government",requiredAdvancements:1,name:"City-States",description:"After CONSTRUCT, IBO's Settler is moved to the largest city in City-Track Order that can still grow."}]},huns:{advancements:[{category:"Agriculture",requiredAdvancements:1,name:"Nomads",description:"During setup place settlements on 0, 1, 3, and 5 of scale."},{category:"Agriculture",requiredAdvancements:2,name:"Mounted Archers",description:"Leader leaves behind cavalry instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:1,name:"Raiders",description:"Your lone settlers within \"Land Aggression Range\" can't FOUND or form Trade Routes with IBO's cities."},{category:"Any Government",requiredAdvancements:1,name:"Hunnic Tribes",description:'Will pay a culture to redirect "Barbarians Move" Events to you instead of him.'}]},india:{advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Indian Elephants",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Spirituality",requiredAdvancements:2,name:"Proselytism",description:"Range for INFLUENCE CULTURE is increase by 1."},{category:"Economy",requiredAdvancements:2,name:"Prosperity",description:"During Raze City, all his cities are made happy . Gains 1 culture for each of your cities under his influence."},{category:"Traditions",requiredAdvancements:2,name:"Peace & Poetry",description:'During "Complete Objectives", Gain 1 mood for each happy city. Pay 4 mood to ADVANCE.'}]},japan:{advancements:[{category:"Agriculture",requiredAdvancements:3,name:"Pottery",description:'After an ADVANCE, gain 1 mood . During "Complete Objectives", pay 3 mood for 2 culture.'},{category:"Agriculture",requiredAdvancements:2,name:"Horsemanship",description:"Leader leaves behind cavalry instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:1,name:"Subterfuge",description:"If you play a Non-Combat Action card and you're within 2 of IBO's cities, roll a die. On 5 or 6, return card to your hand canceled."},{category:"Any Government",requiredAdvancements:1,name:"Shogunate",description:'During "Complete Objectives", IBO gains 1 action card. In Battle, if his action card fails to trigger, discard it and IBO gains a combat die.'}]},maya:{advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Terracing",description:'FOUND in reverse Terrain order. During "Complete Objectives", gain 1 mood per mountain on or adjacent to his cities. Pay 6 mood to CONSTRUCT.'},{category:"Traditions",requiredAdvancements:1,name:"Stelas",description:"After CONSTRUCT, gain 1 culture."},{category:"Traditions",requiredAdvancements:2,name:"Ballcourts",description:"After RECRUIT, IBO recruits 1 more unit. Starting again at beginning of reverse City-Track order."},{category:"Science",requiredAdvancements:2,name:"Calendar",description:"IBO pays 1 culture to cancel any event icon he triggers."}]},persia:{advancements:[{category:"Agriculture",requiredAdvancements:2,name:"Elephants",description:"Leader leaves behind elephant instead of infantry when it moves."},{category:"Warfare",requiredAdvancements:2,name:"Immortals",description:"In Battle, IBO spends up to 4 culture for +1 combat value each, if it gains another hit"},{category:"Spirituality",requiredAdvancements:2,name:"Zoroastrianism",description:"May target one of your army units outside a city with an INFLUENCE CULTURE action. (Causes battle, if in army)"},{category:"Economy",requiredAdvancements:2,name:"Banking",description:'During "Complete Objectives", if he has any culture, he gains 1 culture.'}]},phoenicia:{advancements:[{category:"Maritime",requiredAdvancements:1,name:"City Independence",description:"IBO's Ports can not be Culturally Influence and are worth an extra &frac12; victory point."},{category:"Maritime",requiredAdvancements:2,name:"Biremes",description:"+2 combat value in Naval Combat."},{category:"Education",requiredAdvancements:1,name:"Alphabet",description:'During "Complete Objectives", gain 1 mood for each of your cities within 2 of his cities. Pay 4 mood to both ADVANCE and Gain 1 culture.'},{category:"Economy",requiredAdvancements:2,name:"Cedars & Dyes",description:'During "Complete Objectives", if you have a port within 3 of one of his ports, IBO gains 2 culture.'}]},rome:{advancements:[{category:"Construction",requiredAdvancements:2,name:"Aqueducts",description:'When acquired, perform an ADVANCE in Agriculture. IBO ignores "Exhausted Land" Events.'},{category:"Construction",requiredAdvancements:3,name:"Imperial Roads",description:"Before defending an attack, IBO will move one unit from the closest city to the attacked city. (May exceed City-Limit but not 4.)"},{category:"Economy",requiredAdvancements:1,name:"Slave Economy",description:"After CONSTRUCT (not FOUND), IBO gains mood. Pay 3 mood and make city angry to perform CONSTRUCT (not FOUND) again in same city."},{category:"Any Government",requiredAdvancements:1,name:"Provinces",description:"Leader leaves behind culture instead of infantry when it moves and captured cities are made neutral instead of angry."}]},vikings:{advancements:[{category:"Maritime",requiredAdvancements:1,name:"Shipcraft",description:"During land ATTACK or FOUND, IBO may count through a single water without ships in the sea area. "},{category:"Maritime",requiredAdvancements:2,name:"Longships",description:"When acquired, RECRUIT a Ship (if possible) +1 Naval Aggression Range."},{category:"Economy",requiredAdvancements:2,name:"Marauders",description:'During "Complete Objectives", you lose 1 resource for each of your cities within 2 of IBO\'s ships.'},{category:"Spirituality",requiredAdvancements:2,name:"Runestones",description:"After any battle that IBO loses 2+ units, place 1 culture on this card. Each mood is 1 victory point."}]}},g={aztecs:{action:"Attack"},babylonia:{action:"Advance"},carthage:{action:"Recruit"},celts:{action:"Attack"},china:{action:"Construct"},egypt:{action:"Influence"},greece:{action:"Recruit"},huns:{action:"Construct"},india:{action:"Influence"},japan:{action:"Attack"},maya:{action:"Advance"},persia:{action:"Influence"},phoenicia:{action:"Advance"},rome:{action:"Construct"},vikings:{action:"Recruit"}};var h=r(3574);const p=[{name:"aztecs",display:"Aztecs"},{name:"babylonia",display:"Babylonia"},{name:"carthage",display:"Carthage"},{name:"celts",display:"Celts"},{name:"china",display:"China"},{name:"egypt",display:"Egypt"},{name:"greece",display:"Greece"},{name:"huns",display:"Huns"},{name:"india",display:"India"},{name:"japan",display:"Japan"},{name:"maya",display:"Maya"},{name:"persia",display:"Persia"},{name:"phoenicia",display:"Phoenicia"},{name:"rome",display:"Rome"},{name:"vikings",display:"Vikings"}],a=p.map(i=>({...i,ibo:{...y[i.name],...g[i.name],...h.t[i.name]}})).reduce((i,n)=>({...i,[n.name]:n}),{})},3574:(C,u,r)=>{r.d(u,{t:()=>y});const y={aztecs:{leaders:[{name:"Acamapichitli",ability:"After CONSTRUCT, if able, spend 2 captives to CONSTRUCT again."},{name:"Ahuitzotl",ability:"When attacking a city at least 3 spaces away from any IBO city, +1 block in the first round."},{name:"Marqzen",ability:"When in battle against an army of 3 or more UrlHandlingStrategy, enemy gets -1 attack die."}]},babylonia:{leaders:[{name:"Hammurabi",ability:"Place a fortress on the scale. After a CONSTRUCT, shift all fortresses one more space left swapping with any piece they bump into."},{name:"Nabopolassar",ability:"After any of IBO's neutrel cities are captured, take a RECRUIT action. If the city was happy, take two RECRUIT actions."},{name:"Nebuchadnezzar II",ability:"Reveal the Great Garden wonder. You can\t build it. IBO can build it without the proper category unlocked. On build, IBO gains: 3 Culture, 2 cubes in Agriculture or Construction, and 2 city pieces."}]},carthage:{leaders:[{name:"Hannibal",ability:"In the first round of combat, you can never gain more than +2 strength vs IBO's armies."},{name:"Hanno",ability:"+2 strength in all naval battles."},{name:"Queen Dido",ability:"After a FOUND,j IBO performs an additional action."}]},celts:{leaders:[{name:"Queen Boudica",ability:"After a FOUND, shift left-most settlement two more spaces left, swapping with any piece it bumps into."},{name:"Vercingetorix",ability:"During an ATTACK action, once the battle has been determined, IBO RECRUITS 1 unit into the army that is going to attack."},{name:"Viriatus",ability:"IBO will play action cards for all barbarian battles against you."}]},china:{leaders:[{name:"Empress Wu Zetian",ability:"After an ADVANCE in Agriculture, IBO pays culture to take another ADVANCE action."},{name:"Qin Shi Huang",ability:"Reveal the Great Wall wonder. You can't build it. IBO can build it without property category unlocked. On build, IBO gains: 3 Culture, 2 cubes in Agriculture or Construction, and 2 city pieces."},{name:"Sun Tzu",ability:"After an ADVANCE in warfare, IBO pays one culture to take another ADVANCE action."}]},egypt:{leaders:[{name:"Cleopatra",ability:"INFLUENCE CULTURE range incread by 1 in all cities."},{name:"Imhotep",ability:"After a RECRUIT or CONSTRUCT action, set aside a cube into a pool. Remove 2 cubes from the pool to ADVANCE."},{name:"Ramses II",ability:"+2 strength against coastal cities."}]},greece:{leaders:[{name:"Alexander the Great",ability:"For all battles, gains +1 strength for each city minus 1"},{name:"Leonidas",ability:"+2 strength for each unit IBO's army is outnumbered by."},{name:"Pericles",ability:"After an ADVANCE in education, IBO pays culture to take another ADVANCE action."}]},huns:{leaders:[{name:"Attila",ability:"In 1st round of battle where IBO has cavalry, cavalry clash icons act as both +2 strength and 1 block."},{name:"Bleda",ability:"When attacking a city, defender cannot use action cards in the 1st round of combat."},{name:"Rugila",ability:"IBO will capture size 1 barbarian cities instead of razing them. Barbarian cities are made happy instead of angry when captured."}]},india:{leaders:[{name:"Akbar the Great",ability:"+1 strength for each elephant he has in battle."},{name:"Ashoka the Great",ability:"IBO may reroll failed INFLUENCE CULTURE rolles once."},{name:"Maharaja Sri Gupta",ability:"After an ADVANCE in a new category, IBO pays culture to take another ADVANCE action."}]},japan:{leaders:[{name:"Emperor Go-Toba",ability:"Academies gain the power of observatories. Observatories gain the power of academies."},{name:"Emperor Jimmu",ability:"All IBO fortresses are +3 strength instead of +1."},{name:"Empress Suiko",ability:"Before and INFLUENCE CULTURE action, IBO influcences back a piece under your influence in one of his cities. Then makes the normal attempt."}]},maya:{leaders:[{name:"K'inich Janaab' Pakal",ability:"When defending, +1 block in first round of combat."},{name:"Siyaj K'ak'",ability:"After CONSTRUCT, perform an INFLUENCE CULTURE from the city just constructed."},{name:"Wak Chanil Ajaw",ability:"+2 strength when attacking."}]},persia:{leaders:[{name:"Cyrus the Great",ability:"During combat, if IBO's action card doesn't trigger, discard it to give his army +2 strength."},{name:"Darius",ability:"After CONSTRUCT, IBO pays culture to a pool. When 2 culture are in the pool, discard both and CONSTRUCT again."},{name:"Xerxes",ability:"During wonder check, IBO will build Wonder with 3 non-settlement city pieces and 3 culture."}]},phoenicia:{leaders:[{name:"Ithobaal",ability:"+1 strength per temple built in IBO's cities."},{name:"King Hiram",ability:"After an ADVANCE in construction, IBO pays culture to take another ADVANCE action."},{name:"Pygmalion",ability:"During COMPLETE OBJECTIVES, IBO gains 1 culture if any of his ships or cities are within 2 of any of your cities."}]},rome:{leaders:[{name:"Emperor Augustus",ability:"+2 strength when attacking."},{name:"Gaius Julius Caesar",ability:"After IBO captures a city, increase its mood one step and RECRUIT in that city alone."},{name:"Sulla",ability:"IBO's cities are considered 2 spaces further away during your INFLUENCE CULTURE attempts."}]},vikings:{leaders:[{name:"Cnut the Great",ability:"During end game scoring, IBO's city furthest away from his starting space earns him &frac12; point per space away."},{name:"Eric the Red",ability:"Put a port on the scale. During end game scoring, IBO gets 1 point per each sea area he has a ship present."},{name:"Ragnar Lodbrok",ability:"+2 strength in any land battle adjacent to a sea area with his ships."}]}}},1446:(C,u,r)=>{r.d(u,{mj:()=>v});var y=r(5438),g=r(4036),h=r(8180),p=r(7398);class a{get advancements(){return[...this._advancements]}get leaderState(){return this._leaderState}constructor({id:c,civ:b,advancements:e,created:t,updated:s,leaderState:f}){this.updated=null,this.id=c,this.civ=b,this._leaderState=f,this._advancements=[...e||[]],this.created=t?new Date(t):new Date,this.updated=s?new Date(s):null}static fromSave(c){return new a(c)}updateLeaderState(c){this._leaderState=c}toggleAdvancement(c){this._advancements=this._advancements.includes(c)?this._advancements.filter(b=>b!==c):[...this._advancements,c]}toSave(c){return{name:`${c} (${(new Date).toLocaleDateString()})`,id:this.id,civ:this.civ,created:this.created,updated:new Date,leaderState:this._leaderState,advancements:[...this._advancements]}}}var i=r(1798),n=r(3574),m=r(4946);const o_gameSave="coc-ibo-datastore--game--";let v=(()=>{var l;class c{constructor(){this.gameList=new y.t(1),this.gameList$=this.gameList.asObservable(),this.clearEmptyGames(),this.loadGameList()}createGame(e){return(0,g.z)(this.createNewGame(e))}clearSaves(){localStorage.clear(),this.loadGameList()}loadGame(e){const t=a.fromSave(JSON.parse(localStorage.getItem(`${o_gameSave}${e}`)||"{}"));if(!(t||{}).id)throw new Error(e);return{game:t,civ:i.WJ[t.civ]}}saveGame(e){const s=e.toSave((i.WJ[e.civ]||{}).display||"");return this.createOrUpdateGameList(s),localStorage.setItem(`${o_gameSave}${s.id}`,JSON.stringify(s)),s.id}deleteGame(e){localStorage.removeItem(`${o_gameSave}${e}`),this.deleteFromGameList(e)}clearEmptyGames(){localStorage.removeItem(`${o_gameSave}`)}deleteFromGameList(e){this.gameList$.pipe((0,h.q)(1)).subscribe(t=>this.updateGameListStorage(t.filter(s=>s.id!==e)))}createOrUpdateGameList(e){this.gameList$.pipe((0,h.q)(1)).subscribe(t=>{let f=t.find(A=>A.id===e.id)?t.filter(A=>A.id!==e.id):[...t];f=[...f,{id:e.id,name:e.name}],this.updateGameListStorage(f)})}updateGameListStorage(e){localStorage.setItem("coc-ibo-datastore--gamelist",JSON.stringify(e||null)),this.gameList.next(e||null)}loadGameList(){const e=JSON.parse(localStorage.getItem("coc-ibo-datastore--gamelist")||"[]");return this.gameList.next(e||[]),this.gameList$}createNewGame(e){return this.gameList$.pipe((0,h.q)(1),(0,p.U)(t=>{const s=this.generateUniqueKey(t.map(A=>A.id)),f={active:null,defeated:[],inactive:[...n.t[e].leaders]};return this.saveGame(new a({id:s,civ:e,leaderState:f}))}))}generateUniqueKey(e=[]){let t="",s=!1;for(;!s;)t=this.generateSubKey()+"-"+this.generateSubKey()+"-"+this.generateSubKey(),s=!e.includes(t);return t}generateSubKey(e=4){let t="",s=0;for(;s<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random())),s+=1;return t}}return(l=c).\u0275fac=function(e){return new(e||l)},l.\u0275prov=m.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),c})()},5438:(C,u,r)=>{r.d(u,{t:()=>h});var y=r(8645);const g={now:()=>(g.delegate||Date).now(),delegate:void 0};class h extends y.x{constructor(a=1/0,i=1/0,n=g){super(),this._bufferSize=a,this._windowTime=i,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=i===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,i)}next(a){const{isStopped:i,_buffer:n,_infiniteTimeWindow:m,_timestampProvider:o,_windowTime:d}=this;i||(n.push(a),!m&&n.push(o.now()+d)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const i=this._innerSubscribe(a),{_infiniteTimeWindow:n,_buffer:m}=this,o=m.slice();for(let d=0;d<o.length&&!a.closed;d+=n?1:2)a.next(o[d]);return this._checkFinalizedStatuses(a),i}_trimBuffer(){const{_bufferSize:a,_timestampProvider:i,_buffer:n,_infiniteTimeWindow:m}=this,o=(m?1:2)*a;if(a<1/0&&o<n.length&&n.splice(0,n.length-o),!m){const d=i.now();let v=0;for(let l=1;l<n.length&&n[l]<=d;l+=2)v=l;v&&n.splice(0,v+1)}}}},4036:(C,u,r)=>{r.d(u,{z:()=>h});var y=r(6973),g=r(1887);function h(p,a){const i="object"==typeof a;return new Promise((n,m)=>{const o=new g.Hp({next:d=>{n(d),o.unsubscribe()},error:m,complete:()=>{i?n(a.defaultValue):m(new y.K)}});p.subscribe(o)})}}}]);